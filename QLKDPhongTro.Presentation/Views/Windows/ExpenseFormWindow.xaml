<Window x:Class="QLKDPhongTro.Presentation.Views.Windows.ExpenseFormWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:viewModels="clr-namespace:QLKDPhongTro.Presentation.ViewModels"
		xmlns:converters="clr-namespace:QLKDPhongTro.Presentation.Converters"
        Title="Ghi nhận chi phí - Quản Lý Phòng Trọ"
        Height="600"
        Width="600"
        WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize"
        Background="#F5F5F5"
        FontFamily="Segoe UI">

	<Window.DataContext>
		<viewModels:ExpenseFormViewModel/>
	</Window.DataContext>

	<Window.Resources>
		<!-- Style cho textbox -->
		<Style TargetType="{x:Type TextBox}" x:Key="FormTextBoxStyle">
			<Setter Property="Height" Value="40"/>
			<Setter Property="Padding" Value="10"/>
			<Setter Property="VerticalContentAlignment" Value="Center"/>
			<Setter Property="BorderBrush" Value="#D1D5DB"/>
			<Setter Property="BorderThickness" Value="1"/>
			<Setter Property="Background" Value="White"/>
			<Setter Property="FontSize" Value="14"/>
		</Style>

		<!-- Style cho combobox -->
		<Style TargetType="{x:Type ComboBox}" x:Key="FormComboBoxStyle">
			<Setter Property="Height" Value="40"/>
			<Setter Property="Padding" Value="10"/>
			<Setter Property="VerticalContentAlignment" Value="Center"/>
			<Setter Property="BorderBrush" Value="#D1D5DB"/>
			<Setter Property="BorderThickness" Value="1"/>
			<Setter Property="Background" Value="White"/>
			<Setter Property="FontSize" Value="14"/>
		</Style>

		<!-- Style cho nút -->
		<Style TargetType="{x:Type Button}" x:Key="FormButtonStyle">
			<Setter Property="Height" Value="40"/>
			<Setter Property="Padding" Value="20,0"/>
			<Setter Property="FontSize" Value="14"/>
			<Setter Property="FontWeight" Value="Medium"/>
			<Setter Property="BorderThickness" Value="0"/>
			<Setter Property="Cursor" Value="Hand"/>
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="{x:Type Button}">
						<Border CornerRadius="6" Background="{TemplateBinding Background}">
							<ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
						</Border>
						<ControlTemplate.Triggers>
							<Trigger Property="IsMouseOver" Value="True">
								<Setter Property="Background" Value="#0EBE8C"/>
							</Trigger>
						</ControlTemplate.Triggers>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>

		<!-- Converters -->
		<BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
		<converters:NullToVisibilityConverter x:Key="NullToVisibilityConverter"/>
	</Window.Resources>

	<Grid Margin="20">
		<Grid.RowDefinitions>
			<RowDefinition Height="Auto"/>
			<RowDefinition Height="*"/>
			<RowDefinition Height="Auto"/>
		</Grid.RowDefinitions>

		<!-- Header -->
		<StackPanel Grid.Row="0" Margin="0,0,0,20">
			<TextBlock Text="💸 Ghi nhận chi phí"
                       FontSize="20"
                       FontWeight="Bold"
                       Foreground="#3B4758"/>
			<TextBlock Text="Thêm khoản chi phí phát sinh mới"
                       FontSize="14"
                       Foreground="#586A84"
                       Margin="0,5,0,0"/>
		</StackPanel>

		<!-- Form Content -->
		<Border Grid.Row="1"
                Background="White"
                CornerRadius="8"
                Padding="20">
			<Border.Effect>
				<DropShadowEffect Color="#A9A8B6" Opacity="0.1" ShadowDepth="4" BlurRadius="20"/>
			</Border.Effect>

			<Grid>
				<Grid.RowDefinitions>
					<RowDefinition Height="Auto"/>
					<RowDefinition Height="Auto"/>
					<RowDefinition Height="Auto"/>
					<RowDefinition Height="Auto"/>
					<RowDefinition Height="Auto"/>
					<RowDefinition Height="Auto"/>
					<RowDefinition Height="*"/>
				</Grid.RowDefinitions>
				<Grid.ColumnDefinitions>
					<ColumnDefinition Width="Auto"/>
					<ColumnDefinition Width="*"/>
				</Grid.ColumnDefinitions>

				<!-- Áp dụng cho thanh toán -->
				<TextBlock Grid.Row="0" Grid.Column="0"
                           Text="Áp dụng cho:"
                           VerticalAlignment="Center"
                           Margin="0,0,15,15"/>
				<ComboBox Grid.Row="0" Grid.Column="1"
                          Style="{StaticResource FormComboBoxStyle}"
                          ItemsSource="{Binding Payments}"
                          DisplayMemberPath="ThangNam"
                          SelectedItem="{Binding SelectedPayment}"
                          Margin="0,0,0,15">
					<!-- Items sẽ được binding từ ViewModel -->
				</ComboBox>

				<!-- Loại chi phí -->
				<TextBlock Grid.Row="1" Grid.Column="0"
                           Text="Loại chi phí:"
                           VerticalAlignment="Center"
                           Margin="0,0,15,15"/>
				<ComboBox Grid.Row="1" Grid.Column="1"
                          Style="{StaticResource FormComboBoxStyle}"
                          ItemsSource="{Binding ExpenseTypes}"
                          SelectedItem="{Binding SelectedExpenseType}"
                          Margin="0,0,0,15">
					<!-- Items sẽ được binding từ ViewModel -->
				</ComboBox>

				<!-- Số tiền -->
				<TextBlock Grid.Row="2" Grid.Column="0"
                           Text="Số tiền:"
                           VerticalAlignment="Center"
                           Margin="0,0,15,15"/>
				<TextBox Grid.Row="2" Grid.Column="1"
                         Style="{StaticResource FormTextBoxStyle}"
                         Text="{Binding Amount, StringFormat=N0}"
                         Margin="0,0,0,15"/>

				<!-- Ngày chi -->
				<TextBlock Grid.Row="3" Grid.Column="0"
                           Text="Ngày chi:"
                           VerticalAlignment="Center"
                           Margin="0,0,15,15"/>
				<DatePicker Grid.Row="3" Grid.Column="1"
                            Height="40"
                            VerticalAlignment="Center"
                            SelectedDate="{Binding ExpenseDate}"
                            Margin="0,0,0,15"/>

				<!-- Mô tả -->
				<TextBlock Grid.Row="4" Grid.Column="0"
                           Text="Mô tả:"
                           VerticalAlignment="Center"
                           Margin="0,0,15,15"/>
				<TextBox Grid.Row="4" Grid.Column="1"
                         Style="{StaticResource FormTextBoxStyle}"
                         Text="{Binding Description}"
                         Margin="0,0,0,15"/>

				<!-- Thông tin thanh toán (chỉ hiển thị khi có thanh toán được chọn) -->
				<Border Grid.Row="5" Grid.Column="0" Grid.ColumnSpan="2"
                        Background="#F8F9FA"
                        CornerRadius="6"
                        Padding="10"
                        Margin="0,0,0,15"
                        Visibility="{Binding SelectedPayment, Converter={StaticResource NullToVisibilityConverter}}">
					<StackPanel>
						<TextBlock Text="Thông tin thanh toán:"
                                   FontWeight="SemiBold"
                                   Margin="0,0,0,5"/>
						<Grid>
							<Grid.ColumnDefinitions>
								<ColumnDefinition Width="*"/>
								<ColumnDefinition Width="*"/>
							</Grid.ColumnDefinitions>
							<StackPanel Grid.Column="0">
								<TextBlock Text="{Binding SelectedPayment.ThangNam, StringFormat='Tháng: {0}'}"
                                           FontSize="12"/>
								<TextBlock Text="{Binding SelectedPayment.TongTien, StringFormat='Tổng tiền: {0:N0} VNĐ'}"
                                           FontSize="12"/>
							</StackPanel>
							<StackPanel Grid.Column="1">
								<TextBlock Text="{Binding SelectedPayment.TrangThaiThanhToan, StringFormat='Trạng thái: {0}'}"
                                           FontSize="12"/>
								<TextBlock Text="{Binding SelectedPayment.NgayThanhToan, StringFormat='Ngày TT: {0:dd/MM/yyyy}'}"
                                           FontSize="12"
                                           Visibility="{Binding SelectedPayment.NgayThanhToan, Converter={StaticResource NullToVisibilityConverter}}"/>
							</StackPanel>
						</Grid>
					</StackPanel>
				</Border>

				<!-- Ghi chú -->
				<TextBlock Grid.Row="6" Grid.Column="0"
                           Text="Ghi chú:"
                           VerticalAlignment="Top"
                           Margin="0,10,15,0"/>
				<TextBox Grid.Row="6" Grid.Column="1"
                         Height="80"
                         Padding="10"
                         VerticalContentAlignment="Top"
                         TextWrapping="Wrap"
                         BorderBrush="#D1D5DB"
                         BorderThickness="1"
                         Background="White"
                         Text="{Binding Notes}"/>
			</Grid>
		</Border>

		<!-- Buttons -->
		<StackPanel Grid.Row="2"
                    Orientation="Horizontal"
                    HorizontalAlignment="Right"
                    Margin="0,20,0,0">
			<StackPanel.Resources>
				<Style TargetType="Button">
					<Setter Property="Margin" Value="5,0,0,0"/>
				</Style>
			</StackPanel.Resources>
			<Button Content="Hủy"
                    Width="100"
                    Style="{StaticResource FormButtonStyle}"
                    Background="#6B7280"
                    Foreground="White"
                    Command="{Binding CancelCommand}"/>
			<Button Content="Lưu chi phí"
                    Width="120"
                    Style="{StaticResource FormButtonStyle}"
                    Background="#10D096"
                    Foreground="White"
                    Command="{Binding SaveExpenseCommand}"/>
		</StackPanel>
	</Grid>
</Window>